[{"id":"5553381b.ce0098","type":"tab","label":"eWine-orchestrator","disabled":false,"info":""},{"id":"be8a0902.f0ab98","type":"mqtt-broker","z":"","broker":"127.0.0.1","port":"1883","clientid":"","usetls":false,"compatmode":true,"keepalive":"60","cleansession":true,"willTopic":"","willQos":"0","willPayload":"","birthTopic":"","birthQos":"0","birthPayload":""},{"id":"b2367ffe.ec095","type":"ds18b20","z":"5553381b.ce0098","name":"temperature","sensorid":"28-04168471a4ff","timer":"1","x":170,"y":40,"wires":[["ff81d48f.8be628"]]},{"id":"cd604d1d.33b9c","type":"mqtt out","z":"5553381b.ce0098","name":"publisher","topic":"temperature","qos":"1","retain":"false","broker":"be8a0902.f0ab98","x":680,"y":280,"wires":[]},{"id":"2e7cca26.f583c6","type":"mqtt in","z":"5553381b.ce0098","name":"subscriber","topic":"temperature","qos":"1","broker":"be8a0902.f0ab98","x":160,"y":400,"wires":[["668665.a35cf99c","a2b704ba.36f4f8"]]},{"id":"d811ab33.0253b8","type":"batcher","z":"5553381b.ce0098","name":"","maxTopics":1,"maxMessagesPerTopic":"10","maxDelay":-1,"x":660,"y":40,"wires":[["76f8d656.f87cb8"]]},{"id":"ff81d48f.8be628","type":"function","z":"5553381b.ce0098","name":"add timestamp","func":"msg.payload = 't:' + msg.payload + ',s:' + new Date().getTime();\nreturn msg;","outputs":1,"noerr":0,"x":420,"y":40,"wires":[["d811ab33.0253b8"]]},{"id":"bc8b36b3.25f828","type":"function","z":"5553381b.ce0098","name":"add api key","func":"msg.payload = {};\nmsg.headers = {};\nmsg.headers['X-api-key'] = 'f807a41ee201b9d499b0149ebb5e3ccc80dd6486';\n\nreturn msg;","outputs":1,"noerr":0,"x":170,"y":200,"wires":[["30e7601e.e95c2"]]},{"id":"30e7601e.e95c2","type":"http request","z":"5553381b.ce0098","name":"enable Wi-Fi","method":"POST","ret":"obj","url":"127.0.0.1:5000/enable/wlan0","tls":"","x":170,"y":260,"wires":[["97652429.76c0f8"]]},{"id":"76f8d656.f87cb8","type":"change","z":"5553381b.ce0098","name":"store batch","rules":[{"t":"set","p":"payload","pt":"flow","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":430,"y":120,"wires":[["bc8b36b3.25f828"]]},{"id":"97652429.76c0f8","type":"switch","z":"5553381b.ce0098","name":"check enable","property":"payload.code","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"false","outputs":2,"x":170,"y":320,"wires":[["a9b7f475.5742a8","7341e36e.e0afbc"],["609482c9.0eb69c"]]},{"id":"e1f776c7.c2e1a8","type":"http request","z":"5553381b.ce0098","name":"connect Wi-Fi","method":"POST","ret":"obj","url":"127.0.0.1:5000/connect/wlan0:Telecom-86623587","tls":"","x":420,"y":260,"wires":[["7ad990a2.4b717"]]},{"id":"7ad990a2.4b717","type":"switch","z":"5553381b.ce0098","name":"check connect","property":"payload.code","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"false","outputs":2,"x":420,"y":320,"wires":[["ad0cb7da.0202b8","62f193e9.6370ec"],["dd0044fa.75a9f8"]]},{"id":"62f193e9.6370ec","type":"change","z":"5553381b.ce0098","name":"load batch","rules":[{"t":"set","p":"payload","pt":"msg","to":"payload","tot":"flow"}],"action":"","property":"","from":"","to":"","reg":false,"x":670,"y":200,"wires":[["cd604d1d.33b9c"]]},{"id":"668665.a35cf99c","type":"debug","z":"5553381b.ce0098","name":"output","active":true,"console":"false","complete":"true","x":670,"y":660,"wires":[]},{"id":"ad0cb7da.0202b8","type":"debug","z":"5553381b.ce0098","name":"connect ok","active":true,"console":"false","complete":"payload","x":690,"y":380,"wires":[]},{"id":"dd0044fa.75a9f8","type":"debug","z":"5553381b.ce0098","name":"connect failed","active":true,"console":"false","complete":"payload","x":700,"y":420,"wires":[]},{"id":"a9b7f475.5742a8","type":"debug","z":"5553381b.ce0098","name":"enable ok","active":true,"console":"false","complete":"payload","x":680,"y":460,"wires":[]},{"id":"609482c9.0eb69c","type":"debug","z":"5553381b.ce0098","name":"enable failed","active":true,"console":"false","complete":"payload","x":690,"y":500,"wires":[]},{"id":"7341e36e.e0afbc","type":"function","z":"5553381b.ce0098","name":"add api key","func":"msg.payload = {};\nmsg.headers = {};\nmsg.headers['X-api-key'] = 'f807a41ee201b9d499b0149ebb5e3ccc80dd6486';\n\nreturn msg;","outputs":1,"noerr":0,"x":410,"y":200,"wires":[["e1f776c7.c2e1a8"]]},{"id":"5f760f4c.a62c1","type":"http request","z":"5553381b.ce0098","name":"disable Wi-Fi","method":"POST","ret":"obj","url":"127.0.0.1:5000/disable/wlan0","tls":"","x":170,"y":540,"wires":[["dffede07.8bd1e"]]},{"id":"1dacff40.b720c1","type":"debug","z":"5553381b.ce0098","name":"disable ok","active":true,"console":"false","complete":"payload","x":690,"y":540,"wires":[]},{"id":"6972272c.2e5088","type":"debug","z":"5553381b.ce0098","name":"disable failed","active":true,"console":"false","complete":"payload","x":690,"y":580,"wires":[]},{"id":"dffede07.8bd1e","type":"switch","z":"5553381b.ce0098","name":"check disable","property":"payload.code","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","outputs":2,"x":180.5,"y":602,"wires":[["1dacff40.b720c1"],["6972272c.2e5088"]]},{"id":"a2b704ba.36f4f8","type":"function","z":"5553381b.ce0098","name":"add api key","func":"msg.payload = {};\nmsg.headers = {};\nmsg.headers['X-api-key'] = 'f807a41ee201b9d499b0149ebb5e3ccc80dd6486';\n\nreturn msg;","outputs":1,"noerr":0,"x":170,"y":480,"wires":[["5f760f4c.a62c1"]]}]